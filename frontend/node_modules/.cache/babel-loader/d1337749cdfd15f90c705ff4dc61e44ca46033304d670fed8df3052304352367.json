{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports._iterSSEMessages = exports.Stream = void 0;\nconst index_1 = require(\"./_shims/index.js\");\nconst error_1 = require(\"./error.js\");\nconst line_1 = require(\"./internal/decoders/line.js\");\nconst stream_utils_1 = require(\"./internal/stream-utils.js\");\nconst error_2 = require(\"./error.js\");\nclass Stream {\n  constructor(iterator, controller) {\n    this.iterator = iterator;\n    this.controller = controller;\n  }\n  static fromSSEResponse(response, controller) {\n    let consumed = false;\n    async function* iterator() {\n      if (consumed) {\n        throw new Error('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n      }\n      consumed = true;\n      let done = false;\n      try {\n        for await (const sse of _iterSSEMessages(response, controller)) {\n          if (done) continue;\n          if (sse.data.startsWith('[DONE]')) {\n            done = true;\n            continue;\n          }\n          if (sse.event === null || sse.event.startsWith('response.')) {\n            let data;\n            try {\n              data = JSON.parse(sse.data);\n            } catch (e) {\n              console.error(`Could not parse message into JSON:`, sse.data);\n              console.error(`From chunk:`, sse.raw);\n              throw e;\n            }\n            if (data && data.error) {\n              throw new error_2.APIError(undefined, data.error, undefined, undefined);\n            }\n            yield data;\n          } else {\n            let data;\n            try {\n              data = JSON.parse(sse.data);\n            } catch (e) {\n              console.error(`Could not parse message into JSON:`, sse.data);\n              console.error(`From chunk:`, sse.raw);\n              throw e;\n            }\n            // TODO: Is this where the error should be thrown?\n            if (sse.event == 'error') {\n              throw new error_2.APIError(undefined, data.error, data.message, undefined);\n            }\n            yield {\n              event: sse.event,\n              data: data\n            };\n          }\n        }\n        done = true;\n      } catch (e) {\n        // If the user calls `stream.controller.abort()`, we should exit without throwing.\n        if (e instanceof Error && e.name === 'AbortError') return;\n        throw e;\n      } finally {\n        // If the user `break`s, abort the ongoing request.\n        if (!done) controller.abort();\n      }\n    }\n    return new Stream(iterator, controller);\n  }\n  /**\n   * Generates a Stream from a newline-separated ReadableStream\n   * where each item is a JSON value.\n   */\n  static fromReadableStream(readableStream, controller) {\n    let consumed = false;\n    async function* iterLines() {\n      const lineDecoder = new line_1.LineDecoder();\n      const iter = (0, stream_utils_1.ReadableStreamToAsyncIterable)(readableStream);\n      for await (const chunk of iter) {\n        for (const line of lineDecoder.decode(chunk)) {\n          yield line;\n        }\n      }\n      for (const line of lineDecoder.flush()) {\n        yield line;\n      }\n    }\n    async function* iterator() {\n      if (consumed) {\n        throw new Error('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n      }\n      consumed = true;\n      let done = false;\n      try {\n        for await (const line of iterLines()) {\n          if (done) continue;\n          if (line) yield JSON.parse(line);\n        }\n        done = true;\n      } catch (e) {\n        // If the user calls `stream.controller.abort()`, we should exit without throwing.\n        if (e instanceof Error && e.name === 'AbortError') return;\n        throw e;\n      } finally {\n        // If the user `break`s, abort the ongoing request.\n        if (!done) controller.abort();\n      }\n    }\n    return new Stream(iterator, controller);\n  }\n  [Symbol.asyncIterator]() {\n    return this.iterator();\n  }\n  /**\n   * Splits the stream into two streams which can be\n   * independently read from at different speeds.\n   */\n  tee() {\n    const left = [];\n    const right = [];\n    const iterator = this.iterator();\n    const teeIterator = queue => {\n      return {\n        next: () => {\n          if (queue.length === 0) {\n            const result = iterator.next();\n            left.push(result);\n            right.push(result);\n          }\n          return queue.shift();\n        }\n      };\n    };\n    return [new Stream(() => teeIterator(left), this.controller), new Stream(() => teeIterator(right), this.controller)];\n  }\n  /**\n   * Converts this stream to a newline-separated ReadableStream of\n   * JSON stringified values in the stream\n   * which can be turned back into a Stream with `Stream.fromReadableStream()`.\n   */\n  toReadableStream() {\n    const self = this;\n    let iter;\n    const encoder = new TextEncoder();\n    return new index_1.ReadableStream({\n      async start() {\n        iter = self[Symbol.asyncIterator]();\n      },\n      async pull(ctrl) {\n        try {\n          const {\n            value,\n            done\n          } = await iter.next();\n          if (done) return ctrl.close();\n          const bytes = encoder.encode(JSON.stringify(value) + '\\n');\n          ctrl.enqueue(bytes);\n        } catch (err) {\n          ctrl.error(err);\n        }\n      },\n      async cancel() {\n        await iter.return?.();\n      }\n    });\n  }\n}\nexports.Stream = Stream;\nasync function* _iterSSEMessages(response, controller) {\n  if (!response.body) {\n    controller.abort();\n    throw new error_1.OpenAIError(`Attempted to iterate over a response with no body`);\n  }\n  const sseDecoder = new SSEDecoder();\n  const lineDecoder = new line_1.LineDecoder();\n  const iter = (0, stream_utils_1.ReadableStreamToAsyncIterable)(response.body);\n  for await (const sseChunk of iterSSEChunks(iter)) {\n    for (const line of lineDecoder.decode(sseChunk)) {\n      const sse = sseDecoder.decode(line);\n      if (sse) yield sse;\n    }\n  }\n  for (const line of lineDecoder.flush()) {\n    const sse = sseDecoder.decode(line);\n    if (sse) yield sse;\n  }\n}\nexports._iterSSEMessages = _iterSSEMessages;\n/**\n * Given an async iterable iterator, iterates over it and yields full\n * SSE chunks, i.e. yields when a double new-line is encountered.\n */\nasync function* iterSSEChunks(iterator) {\n  let data = new Uint8Array();\n  for await (const chunk of iterator) {\n    if (chunk == null) {\n      continue;\n    }\n    const binaryChunk = chunk instanceof ArrayBuffer ? new Uint8Array(chunk) : typeof chunk === 'string' ? new TextEncoder().encode(chunk) : chunk;\n    let newData = new Uint8Array(data.length + binaryChunk.length);\n    newData.set(data);\n    newData.set(binaryChunk, data.length);\n    data = newData;\n    let patternIndex;\n    while ((patternIndex = (0, line_1.findDoubleNewlineIndex)(data)) !== -1) {\n      yield data.slice(0, patternIndex);\n      data = data.slice(patternIndex);\n    }\n  }\n  if (data.length > 0) {\n    yield data;\n  }\n}\nclass SSEDecoder {\n  constructor() {\n    this.event = null;\n    this.data = [];\n    this.chunks = [];\n  }\n  decode(line) {\n    if (line.endsWith('\\r')) {\n      line = line.substring(0, line.length - 1);\n    }\n    if (!line) {\n      // empty line and we didn't previously encounter any messages\n      if (!this.event && !this.data.length) return null;\n      const sse = {\n        event: this.event,\n        data: this.data.join('\\n'),\n        raw: this.chunks\n      };\n      this.event = null;\n      this.data = [];\n      this.chunks = [];\n      return sse;\n    }\n    this.chunks.push(line);\n    if (line.startsWith(':')) {\n      return null;\n    }\n    let [fieldname, _, value] = partition(line, ':');\n    if (value.startsWith(' ')) {\n      value = value.substring(1);\n    }\n    if (fieldname === 'event') {\n      this.event = value;\n    } else if (fieldname === 'data') {\n      this.data.push(value);\n    }\n    return null;\n  }\n}\nfunction partition(str, delimiter) {\n  const index = str.indexOf(delimiter);\n  if (index !== -1) {\n    return [str.substring(0, index), delimiter, str.substring(index + delimiter.length)];\n  }\n  return [str, '', ''];\n}","map":{"version":3,"names":["index_1","require","error_1","line_1","stream_utils_1","error_2","Stream","constructor","iterator","controller","fromSSEResponse","response","consumed","Error","done","sse","_iterSSEMessages","data","startsWith","event","JSON","parse","e","console","error","raw","APIError","undefined","message","name","abort","fromReadableStream","readableStream","iterLines","lineDecoder","LineDecoder","iter","ReadableStreamToAsyncIterable","chunk","line","decode","flush","Symbol","asyncIterator","tee","left","right","teeIterator","queue","next","length","result","push","shift","toReadableStream","self","encoder","TextEncoder","ReadableStream","start","pull","ctrl","value","close","bytes","encode","stringify","enqueue","err","cancel","return","exports","body","OpenAIError","sseDecoder","SSEDecoder","sseChunk","iterSSEChunks","Uint8Array","binaryChunk","ArrayBuffer","newData","set","patternIndex","findDoubleNewlineIndex","slice","chunks","endsWith","substring","join","fieldname","_","partition","str","delimiter","index","indexOf"],"sources":["src/streaming.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}